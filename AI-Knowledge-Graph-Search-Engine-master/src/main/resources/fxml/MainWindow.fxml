<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>

<BorderPane xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="org.example.controller.MainController"
            styleClass="root">

    <!-- LEFT SIDEBAR -->
    <left>
        <VBox styleClass="sidebar" prefWidth="220" spacing="0">
            <!-- Logo Header -->
            <HBox styleClass="logo-container" alignment="CENTER_LEFT" spacing="10">
                <padding>
                    <Insets top="20" bottom="20" left="20" right="20"/>
                </padding>
                <Label text="ðŸŽ«" styleClass="logo-icon">
                    <font>
                        <Font size="28"/>
                    </font>
                </Label>
                <Label text="TicketPro" styleClass="logo-text">
                    <font>
                        <Font name="System Bold" size="18"/>
                    </font>
                </Label>
            </HBox>

            <Separator styleClass="sidebar-separator"/>

            <!-- Navigation Menu -->
            <VBox spacing="5" VBox.vgrow="ALWAYS">
                <padding>
                    <Insets top="20" bottom="20" left="10" right="10"/>
                </padding>

                <Button fx:id="btnDashboard" text="ðŸ“Š  Dashboard" styleClass="menu-button active"
                        onAction="#handleDashboard" maxWidth="Infinity"/>

                <Button fx:id="btnTickets" text="ðŸŽ«  Tickets" styleClass="menu-button"
                        onAction="#handleTickets" maxWidth="Infinity"/>

                <Button fx:id="btnNewTicket" text="âž•  New Ticket" styleClass="menu-button"
                        onAction="#handleNewTicket" maxWidth="Infinity"/>

                <Button fx:id="btnCategories" text="ðŸ“  Categories" styleClass="menu-button"
                        onAction="#handleCategories" maxWidth="Infinity"/>

                <Button fx:id="btnUsers" text="ðŸ‘¥  Users" styleClass="menu-button"
                        onAction="#handleUsers" maxWidth="Infinity"/>

                <!-- Spacer -->
                <Region VBox.vgrow="ALWAYS"/>

                <Separator styleClass="sidebar-separator">
                    <VBox.margin>
                        <Insets bottom="10"/>
                    </VBox.margin>
                </Separator>

                <Button fx:id="btnSettings" text="âš™ï¸  Settings" styleClass="menu-button"
                        onAction="#handleSettings" maxWidth="Infinity"/>

                <Button fx:id="btnLogout" text="ðŸšª  Logout" styleClass="menu-button"
                        onAction="#handleLogout" maxWidth="Infinity"/>
            </VBox>
        </VBox>
    </left>

    <!-- CENTER CONTENT -->
    <center>
        <VBox>
            <!-- Top Header Bar -->
            <HBox styleClass="header-bar" alignment="CENTER_LEFT" spacing="20">
                <padding>
                    <Insets top="15" bottom="15" left="30" right="30"/>
                </padding>

                <Label fx:id="lblPageTitle" text="Dashboard" styleClass="page-title">
                    <font>
                        <Font name="System Bold" size="24"/>
                    </font>
                </Label>

                <!-- Spacer -->
                <Region HBox.hgrow="ALWAYS"/>

                <!-- Search Bar -->
                <TextField fx:id="searchField" promptText="Search tickets..." styleClass="search-field"
                           prefWidth="300" onAction="#handleSearch"/>

                <!-- User Profile -->
                <HBox alignment="CENTER" spacing="10" styleClass="user-profile">
                    <Label text="ðŸ‘¤" styleClass="user-icon">
                        <font>
                            <Font size="20"/>
                        </font>
                    </Label>
                    <VBox spacing="2">
                        <Label fx:id="lblUsername" text="Admin User" styleClass="username-label"/>
                        <Label fx:id="lblUserRole" text="Administrator" styleClass="user-role-label"/>
                    </VBox>
                </HBox>
            </HBox>

            <!-- Main Content Area -->
            <StackPane VBox.vgrow="ALWAYS" styleClass="content-area">
                <padding>
                    <Insets top="20" bottom="20" left="30" right="30"/>
                </padding>

                <!-- Dashboard Stats Cards -->
                <VBox fx:id="dashboardView" spacing="20" visible="true">
                    <!-- Stats Cards Row -->
                    <HBox spacing="20">
                        <!-- Total Tickets Card -->
                        <VBox styleClass="stat-card" spacing="10" HBox.hgrow="ALWAYS">
                            <padding>
                                <Insets top="20" bottom="20" left="20" right="20"/>
                            </padding>
                            <Label text="Total Tickets" styleClass="stat-label"/>
                            <Label fx:id="lblTotalTickets" text="248" styleClass="stat-number"/>
                            <Label text="+12 from last week" styleClass="stat-change positive"/>
                        </VBox>

                        <!-- Open Tickets Card -->
                        <VBox styleClass="stat-card open" spacing="10" HBox.hgrow="ALWAYS">
                            <padding>
                                <Insets top="20" bottom="20" left="20" right="20"/>
                            </padding>
                            <Label text="Open" styleClass="stat-label"/>
                            <Label fx:id="lblOpenTickets" text="42" styleClass="stat-number"/>
                            <Label text="Pending resolution" styleClass="stat-change"/>
                        </VBox>

                        <!-- In Progress Card -->
                        <VBox styleClass="stat-card progress" spacing="10" HBox.hgrow="ALWAYS">
                            <padding>
                                <Insets top="20" bottom="20" left="20" right="20"/>
                            </padding>
                            <Label text="In Progress" styleClass="stat-label"/>
                            <Label fx:id="lblProgressTickets" text="18" styleClass="stat-number"/>
                            <Label text="Being worked on" styleClass="stat-change"/>
                        </VBox>

                        <!-- Resolved Card -->
                        <VBox styleClass="stat-card resolved" spacing="10" HBox.hgrow="ALWAYS">
                            <padding>
                                <Insets top="20" bottom="20" left="20" right="20"/>
                            </padding>
                            <Label text="Resolved" styleClass="stat-label"/>
                            <Label fx:id="lblResolvedTickets" text="188" styleClass="stat-number"/>
                            <Label text="This month: 45" styleClass="stat-change positive"/>
                        </VBox>
                    </HBox>

                    <!-- Recent Tickets Section -->
                    <VBox spacing="15" VBox.vgrow="ALWAYS">
                        <HBox alignment="CENTER_LEFT" spacing="15">
                            <Label text="Recent Tickets" styleClass="section-title">
                                <font>
                                    <Font name="System Bold" size="18"/>
                                </font>
                            </Label>
                            <Region HBox.hgrow="ALWAYS"/>
                            <Button text="View All" styleClass="action-button-secondary"
                                    onAction="#handleViewAllTickets"/>
                        </HBox>

                        <TableView fx:id="recentTicketsTable" styleClass="data-table" VBox.vgrow="ALWAYS">
                            <columns>
                                <TableColumn fx:id="colTicketId" text="ID" prefWidth="80"/>
                                <TableColumn fx:id="colTitle" text="Title" prefWidth="250"/>
                                <TableColumn fx:id="colStatus" text="Status" prefWidth="120"/>
                                <TableColumn fx:id="colPriority" text="Priority" prefWidth="100"/>
                                <TableColumn fx:id="colCategory" text="Category" prefWidth="150"/>
                                <TableColumn fx:id="colAssignedTo" text="Assigned To" prefWidth="150"/>
                                <TableColumn fx:id="colCreatedAt" text="Created" prefWidth="120"/>
                            </columns>
                        </TableView>
                    </VBox>
                </VBox>

                <!-- Tickets List View (Hidden by default) -->
                <VBox fx:id="ticketsView" spacing="15" visible="false">
                    <HBox spacing="10" alignment="CENTER_LEFT">
                        <Button text="âž• New Ticket" styleClass="action-button-primary"
                                onAction="#handleNewTicket"/>
                        <Button text="ðŸ”„ Refresh" styleClass="action-button-secondary"
                                onAction="#handleRefresh"/>
                        <Region HBox.hgrow="ALWAYS"/>
                        <ComboBox fx:id="statusFilter" promptText="Filter by Status"
                                  styleClass="filter-combo" prefWidth="150"/>
                        <ComboBox fx:id="priorityFilter" promptText="Filter by Priority"
                                  styleClass="filter-combo" prefWidth="150"/>
                    </HBox>

                    <TableView fx:id="allTicketsTable" styleClass="data-table" VBox.vgrow="ALWAYS">
                        <columns>
                            <TableColumn fx:id="colAllTicketId" text="ID" prefWidth="80"/>
                            <TableColumn fx:id="colAllTitle" text="Title" prefWidth="300"/>
                            <TableColumn fx:id="colAllStatus" text="Status" prefWidth="120"/>
                            <TableColumn fx:id="colAllPriority" text="Priority" prefWidth="100"/>
                            <TableColumn fx:id="colAllCategory" text="Category" prefWidth="150"/>
                            <TableColumn fx:id="colAllAssignedTo" text="Assigned To" prefWidth="150"/>
                            <TableColumn fx:id="colAllCreatedAt" text="Created" prefWidth="120"/>
                            <TableColumn fx:id="colAllActions" text="Actions" prefWidth="100"/>
                        </columns>
                        <placeholder>
                            <VBox alignment="CENTER" spacing="10">
                                <Label text="ðŸŽ«" style="-fx-font-size: 48px; -fx-opacity: 0.3;"/>
                                <Label text="No tickets found" styleClass="empty-state-text"/>
                            </VBox>
                        </placeholder>
                    </TableView>
                </VBox>
            </StackPane>
        </VBox>
    </center>
</BorderPane>